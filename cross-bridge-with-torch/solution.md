
> 甲、乙、丙、丁四个人在晚上过一座桥，桥每次最多容纳两个人一起通过。过桥需要手电筒，而四人一共只有一支手电筒。不允许过桥之后将手电筒扔回，只能让人携带回来。甲、乙、丙、丁单独过桥时间分别为3分钟、4分钟、5分钟、6分钟。请问，怎样安排过桥顺序，才能使四人过桥总时间最短？这个最短时间是几分钟？

据说，小学三年级（甚至二年级）上学期的牛蛙，应该会做这道题。

显然，每次两个人过桥，然后由已经在河对面的某人（不一定是刚过桥的两人之一）将手电筒带回，以此类推。为行文方便，也为方便记忆，将这两个方向分别称为”去程“、”返程“，两件事分别称为“过桥”、“运电筒”。

比较容易想到的是，每次返程，都让最快者运回手电筒。由此推出，每次去程，都由最快者陪同某人，然后最快者自己运电筒返程。这种情况下，每次被陪同过桥者的顺序其实没关系。这样，本题的一种解法就是：(3, 6), 3, (3, 5), 3, (3, 4)。所用总时间为：6 + 5 + 4 + 3 * 2 = 21 分钟。

但也许还有另外一个方案：如果去程是两个最慢者或两个较慢者（而不是最快者+某慢者）一起，总去程时间会节省，因为，最慢者+次慢者一起过桥，只花了最慢时间，而最慢者和次慢者分别由最快者陪同去程，却要花掉最慢时间+次慢时间。当然，这样做，返程时间会增长，因为有些返程不是最快者走的。但总时间到底是增加了还是减少了，一时却也说不好。

用哪个方案呢？分析到这里，已经不太像三年级的题目了。

在网上搜了搜，发现这个题目其实有一定名气，英文世界里有不少名字，如 `the Bridge-Crossing Puzzle`, `the Bridge and Torch Problem`, 等等。它最早出现在1981年的一本书里。

给出终极解法的是[这篇 2002 年 8 月的 paper](http://www.inf.fu-berlin.de/inst/ag-ti/members/uploads/tx_tipublications/Crossing_the_bridge_at_night.pdf)，从 4 个人推广到一般形式的 N 个人，给出了解法和形式化的数学证明。数学证明用了图论，要看明白还是得花点时间……咱们还是直接上结论吧：

如果有 N 个人要过河。每人单独过桥所用时间分别为 t<sub>1</sub>, t<sub>2</sub>, ..., t<sub>N</sub>. （后面为了行文方便，也为了便于记忆，t<sub>i</sub> 既表示某人，也表示该人单独过桥所需时间。）

如果 N = 2，两人一起过去就好了。

如果 N = 3，只需运电筒返程一次，显然应该由最快者负责执行这次运电筒任务。顺序为 (t<sub>1</sub>, t<sub>2</sub>), t<sub>1</sub>, (t<sub>1</sub>, t<sub>3</sub>)。当然 t<sub>2</sub> 和 t<sub>3</sub> 谁先过去都行，对总时间没有影响。

重点来了：如果 N >= 4。需要比较 t<sub>1</sub> + 2t<sub>2</sub> + t<sub>N</sub> 和 2t<sub>1</sub> + t<sub>N-1</sub> + t<sub>N</sub>. 其中，

前者对应 (t<sub>1</sub>, t<sub>2</sub>), t<sub>1</sub>, (t<sub>N-1</sub>, t<sub>N</sub>), t<sub>2</sub> 的方案，也就是 (最快 + 次快), 最快, (最慢 + 次慢), 次快。也就是，两次去程分别是 最快的两个 和 最慢的两个，两次返程分别是河对岸最快的那个(t1或t2)。为方便记忆，简称为“最快俩-最慢俩法”或“快俩慢俩法”。

后者对应 (t<sub>1</sub>, t<sub>N</sub>), t<sub>1</sub>, (t<sub>1</sub>, t<sub>N-1</sub>), t<sub>1</sub>。也就是，最快者分两次陪同最慢的两个人过去，并自己返程。为方便记忆，简称为“最快者陪同法”。

这两种方案，哪种快就用哪种。两趟过后，最慢的两人过桥完毕，运电筒的 t<sub>1</sub> 或t<sub>2</sub> 又回到原地，题目 reduce 成 N - 2 的情况。

继续用上面的方法，每一轮送过去两人，直到 N = 2 或 3.

再简化一下判断条件。(t<sub>1</sub> + 2<sub>t2</sub> + t<sub>N</sub>) - (2t<sub>1</sub> + t<sub>N-1</sub> + t<sub>N</sub>) = t<sub>1</sub> + t<sub>N-1</sub> - 2t<sub>2</sub>.
* 如果 t<sub>2</sub> < (t<sub>1</sub> + t<sub>N-1</sub>) / 2，用“最快俩-最慢俩”法。
* 如果 t<sub>2</sub> > (t<sub>1</sub> + t<sub>N-1</sub>) / 2，用“最快者陪同”法。
* 如果 t<sub>2</sub> = (t<sub>1</sub> + t<sub>N-1</sub>) / 2，哪种都行。

难点来了，如何用二、三年级小学生能看懂的语言描述这个算法？

大原则：
* 共有 N 个人。
* 分成若干轮，每轮把最慢的两个人（或者更准确地说，最慢者和次慢者）送过河去。
* 为了送这两个最慢者，要借助最快者 t<sub>1</sub>，还有可能借助次快者 t<sub>2</sub>。他俩负责运电筒返程。
* 这两个助力者，在这一轮结束后，又回到了还在河这边原地，没动位置。

每一轮怎么送，在两种方案里选。
* 方案一：最快者陪同法：t<sub>1</sub> 分两次分别陪最慢的两个人 t<sub>N-1</sub>、t<sub>N</sub> 过去，并自己运电筒返程。
* 方案二：快俩慢俩法。(最快两人 t<sub>1</sub>, t<sub>2</sub>), t<sub>1</sub>, (最慢两人 t<sub>N-1</sub>, t<sub>N</sub>), t<sub>2</sub>。最快者 t<sub>1</sub> 和次快者 t<sub>2</sub> 分别运行电筒返程一次。为了让 t<sub>2</sub> 能有机会携电筒返程，需要第一步让 t<sub>2</sub> 跟 t<sub>1</sub> 一起过桥并埋伏在河对岸。

每一轮用哪种方案，取决于 t2 和 (t1 + tN-1) / 2 的关系。
如何记忆：
* 要不要借助次快者(t2)，要看t2是否足够快。
	* 如果足够快（小于 t1和tN-1的平均值），t2就可以承担携电筒返程的任务。
	* 如果没那么快（大于 t1和tN-1的平均值），还是让更快的t1执行所有运电筒的任务吧。
	* 如果恰好在中间点（等于 t1 和 tN-1 的平均值），就都可以。
* 为什么是 t1 和 tN-1 的平均值呢？可以这么记，这分别是两种方案里陪同最慢者tN的人。

每一轮过后，最慢的两个人过了河，还需要过河的人少了两个。进入下一轮。

回到小学三年级题目上来，N = 4，只需要一轮就能 reduce 到 N = 2 的情况。
* 如果 t2 > (t1 + t3) / 2，顺序为: (t1, t4), t1, (t1, t3), t1, (t1, t2). 总时间为 2t1 + t2 + t3 + t4.
* 如果 t2 < (t1 + t3) / 2，顺序为: (t1, t2), t1, (t3, t4), t2, (t1, t2). 总时间为 t1 + 3t2 + t4.

原题，3,4,5,6，t2 恰好等于 (t1 + t3) / 2. 用哪种方法都行。

如果四人过桥时间分别为 1, 2, 5, 10。2<(1+5)/2。t2最够快，可以执行运电筒任务。用 最快最慢法。(1,2), 1, (5,10),2, (1,2)。总时间为 17.


如果四人过桥时间分别为 1，3，4，10. 3>(1+4)/2。t2太慢，不适合执行运电筒任务，所以每次都由t1陪同。(1,3),1,(1,4),1,(1,10)。总时间为19.

https://stackoverflow.com/questions/1144207/bridge-crossing-puzzle
推广至：每次可以过多个人而不是两个人。给出了类似算法，但没有证明。这就更不像三年级牛娃能解的题了，就先不看了。


